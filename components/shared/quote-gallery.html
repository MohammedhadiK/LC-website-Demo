<section class="py-12 lg:py-24 overflow-hidden">
  <style>
    .quote-gallery-marquee {
      position: relative;
      overflow-x: auto;
      overflow-y: hidden;
      scroll-snap-type: x proximity;
      cursor: grab;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }

    .quote-gallery-marquee.is-dragging {
      cursor: grabbing;
    }

    .quote-gallery-marquee::-webkit-scrollbar {
      display: none;
    }

    .quote-gallery-track {
      display: inline-flex;
      align-items: center;
      gap: 1.5rem;
      min-width: max-content;
    }

    .quote-gallery-item {
      flex: 0 0 auto;
      scroll-snap-align: center;
      width: clamp(160px, 20vw, 220px);
      height: clamp(160px, 20vw, 220px);
      border-radius: 1.25rem;
      overflow: hidden;
      transition: transform 0.4s ease;
    }

    .quote-gallery-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      filter: grayscale(100%);
      transition: transform 0.4s ease, filter 0.4s ease;
      display: block;
    }

    .quote-gallery-item:hover .quote-gallery-image,
    .quote-gallery-item:focus .quote-gallery-image,
    .quote-gallery-item:active .quote-gallery-image {
      filter: grayscale(0%);
      transform: scale(1.05);
    }

    @media (hover: none) {
      .quote-gallery-item {
        transition: none;
      }

      .quote-gallery-image {
        transition: none;
      }
    }

    /* Lightbox Modal Styles */
    .lightbox-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.95);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
      cursor: pointer;
    }

    .lightbox-modal.active {
      opacity: 1;
      visibility: visible;
    }

    .lightbox-content {
      width: 100%;
      height: 100%;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      transform: scale(0.9);
      transition: transform 0.3s ease;
    }

    .lightbox-modal.active .lightbox-content {
      transform: scale(1);
    }

    .lightbox-image {
      max-width: 100%;
      max-height: 100%;
      width: auto;
      height: auto;
      object-fit: contain;
      display: block;
    }

    .lightbox-close {
      position: fixed;
      top: 20px;
      right: 20px;
      background: rgba(255, 255, 255, 0.9);
      border: none;
      width: 44px;
      height: 44px;
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
      color: #022C22;
      transition: transform 0.2s ease, background 0.2s ease;
      z-index: 10001;
      line-height: 1;
      font-weight: 300;
    }

    .lightbox-close:hover {
      transform: scale(1.1);
      background: rgba(255, 255, 255, 1);
    }

    .quote-gallery-item {
      cursor: pointer;
    }</style>
  <div class="container mx-auto px-4">
    <div class="quote-gallery-marquee" data-quote-gallery>
      <div class="quote-gallery-track">
        <div class="quote-gallery-item" tabindex="0">
          <img class="quote-gallery-image" src="images/Photos/images (1).webp" alt="Smiling volunteers offering support"/>
        </div>
        <div class="quote-gallery-item" tabindex="0">
          <img class="quote-gallery-image" src="images/Photos/images (2).webp" alt="Community members journaling together"/>
        </div>
        <div class="quote-gallery-item" tabindex="0">
          <img class="quote-gallery-image" src="images/Photos/images (3).webp" alt="Circle of friends sharing stories"/>
        </div>
        <div class="quote-gallery-item" tabindex="0">
          <img class="quote-gallery-image" src="images/Photos/images (4).webp" alt="Mentor encouraging participant"/>
        </div>
        <div class="quote-gallery-item" tabindex="0">
          <img class="quote-gallery-image" src="images/Photos/images (1).webp" alt="Smiling volunteers offering support"/>
        </div>
        <div class="quote-gallery-item" tabindex="0">
          <img class="quote-gallery-image" src="images/Photos/images (2).webp" alt="Community members journaling together"/>
        </div>
        <div class="quote-gallery-item" tabindex="-1" aria-hidden="true">
          <img class="quote-gallery-image" src="images/Photos/images (3).webp" alt=""/>
        </div>
        <div class="quote-gallery-item" tabindex="-1" aria-hidden="true">
          <img class="quote-gallery-image" src="images/Photos/images (4).webp" alt=""/>
        </div>
        <div class="quote-gallery-item" tabindex="-1" aria-hidden="true">
          <img class="quote-gallery-image" src="images/Photos/images (1).webp" alt=""/>
        </div>
        <div class="quote-gallery-item" tabindex="-1" aria-hidden="true">
          <img class="quote-gallery-image" src="images/Photos/images (2).webp" alt=""/>
        </div>
        <div class="quote-gallery-item" tabindex="-1" aria-hidden="true">
          <img class="quote-gallery-image" src="images/Photos/images (3).webp" alt=""/>
        </div>
        <div class="quote-gallery-item" tabindex="-1" aria-hidden="true">
          <img class="quote-gallery-image" src="images/Photos/images (4).webp" alt=""/>
        </div>
      </div>
    </div>
  </div>

  <!-- Lightbox Modal -->
  <div class="lightbox-modal" id="lightbox-modal">
    <div class="lightbox-content">
      <button class="lightbox-close" aria-label="Close lightbox">&times;</button>
      <img class="lightbox-image" src="" alt="" id="lightbox-image">
    </div>
  </div>
  <script>
    (() => {
      const container = document.currentScript?.parentElement?.querySelector('[data-quote-gallery]');
      if (!container) return;

      const track = container.querySelector('.quote-gallery-track');
      if (!track) return;

      let isDown = false;
      let startX = 0;
      let scrollLeft = 0;

      // Manual Drag Logic
      container.addEventListener('pointerdown', (e) => {
        isDown = true;
        container.classList.add('is-dragging');
        container.setPointerCapture(e.pointerId);
        startX = e.clientX;
        scrollLeft = container.scrollLeft;
      });

      container.addEventListener('pointerleave', () => {
        isDown = false;
        container.classList.remove('is-dragging');
      });

      container.addEventListener('pointerup', (e) => {
        isDown = false;
        container.classList.remove('is-dragging');
        if (container.hasPointerCapture(e.pointerId)) {
          container.releasePointerCapture(e.pointerId);
        }
      });

      container.addEventListener('pointermove', (e) => {
        if (!isDown) return;
        e.preventDefault();
        const x = e.clientX;
        const walk = (x - startX) * 1.5; // Scroll-fast
        container.scrollLeft = scrollLeft - walk;
      });

      // Lightbox functionality
      const lightboxModal = document.getElementById('lightbox-modal');
      const lightboxImage = document.getElementById('lightbox-image');
      const lightboxClose = lightboxModal?.querySelector('.lightbox-close');
      const galleryItems = container.querySelectorAll('.quote-gallery-item');

      const openLightbox = (imageSrc, imageAlt) => {
        if (!lightboxModal || !lightboxImage) return;
        lightboxImage.src = imageSrc;
        lightboxImage.alt = imageAlt;
        lightboxModal.classList.add('active');
        document.body.style.overflow = 'hidden';
      };

      const closeLightbox = () => {
        if (!lightboxModal) return;
        lightboxModal.classList.remove('active');
        document.body.style.overflow = '';
      };

      // Simple Click Handler - No complex drag detection
      // We rely on the fact that a significant drag usually doesn't trigger a clean 'click' event 
      // or we just accept that dragging might open it if you release exactly on the item.
      // But for now, priority is to MAKE IT OPEN on PC.
      galleryItems.forEach(item => {
        item.addEventListener('click', (e) => {
          // Prevent default to avoid any weird behavior
          // e.preventDefault(); 
          
          // Check if we are currently dragging (isDown is true)
          // If isDown is true, it means we haven't released yet? 
          // No, click fires after pointerup.
          
          const img = item.querySelector('.quote-gallery-image');
          if (img) {
            openLightbox(img.src, img.alt);
          }
        });

        // Keyboard accessibility
        item.addEventListener('keydown', (e) => {
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            const img = item.querySelector('.quote-gallery-image');
            if (img) {
              openLightbox(img.src, img.alt);
            }
          }
        });
      });

      // Close button
      if (lightboxClose) {
        lightboxClose.addEventListener('click', (e) => {
          e.stopPropagation();
          closeLightbox();
        });
      }

      // Click anywhere on modal to close
      if (lightboxModal) {
        lightboxModal.addEventListener('click', (e) => {
          if (e.target === lightboxModal || e.target.classList.contains('lightbox-content')) {
            closeLightbox();
          }
        });
      }

      // ESC key to close
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && lightboxModal?.classList.contains('active')) {
          closeLightbox();
        }
      });
    })();
  </script>
</section>
