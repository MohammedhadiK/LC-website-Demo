<section class="py-12 lg:py-24 overflow-hidden">
  <style>
    .quote-gallery-marquee {
      position: relative;
      overflow-x: auto;
      overflow-y: hidden;
      scroll-snap-type: x proximity;
      cursor: grab;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }

    .quote-gallery-marquee.is-dragging {
      cursor: grabbing;
    }

    .quote-gallery-marquee::-webkit-scrollbar {
      display: none;
    }

    .quote-gallery-track {
      display: inline-flex;
      align-items: center;
      gap: 1.5rem;
      min-width: max-content;
    }

    .quote-gallery-item {
      flex: 0 0 auto;
      scroll-snap-align: center;
      width: clamp(160px, 20vw, 220px);
      height: clamp(160px, 20vw, 220px);
      border-radius: 1.25rem;
      overflow: hidden;
      transition: transform 0.4s ease;
    }

    .quote-gallery-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      filter: grayscale(100%);
      transition: transform 0.4s ease, filter 0.4s ease;
      display: block;
    }

    .quote-gallery-item:hover .quote-gallery-image,
    .quote-gallery-item:focus .quote-gallery-image,
    .quote-gallery-item:active .quote-gallery-image {
      filter: grayscale(0%);
      transform: scale(1.05);
    }

    @media (hover: none) {
      .quote-gallery-item {
        transition: none;
      }

      .quote-gallery-image {
        transition: none;
      }
    }
  </style>
  <div class="container mx-auto px-4">
    <div class="quote-gallery-marquee" data-quote-gallery>
      <div class="quote-gallery-track">
        <div class="quote-gallery-item" tabindex="0">
          <img class="quote-gallery-image" src="images/Photos/images (1).webp" alt="Smiling volunteers offering support"/>
        </div>
        <div class="quote-gallery-item" tabindex="0">
          <img class="quote-gallery-image" src="images/Photos/images (2).webp" alt="Community members journaling together"/>
        </div>
        <div class="quote-gallery-item" tabindex="0">
          <img class="quote-gallery-image" src="images/Photos/images (3).webp" alt="Circle of friends sharing stories"/>
        </div>
        <div class="quote-gallery-item" tabindex="0">
          <img class="quote-gallery-image" src="images/Photos/images (4).webp" alt="Mentor encouraging participant"/>
        </div>
        <div class="quote-gallery-item" tabindex="0">
          <img class="quote-gallery-image" src="images/Photos/images (1).webp" alt="Smiling volunteers offering support"/>
        </div>
        <div class="quote-gallery-item" tabindex="0">
          <img class="quote-gallery-image" src="images/Photos/images (2).webp" alt="Community members journaling together"/>
        </div>
        <div class="quote-gallery-item" tabindex="-1" aria-hidden="true">
          <img class="quote-gallery-image" src="images/Photos/images (3).webp" alt=""/>
        </div>
        <div class="quote-gallery-item" tabindex="-1" aria-hidden="true">
          <img class="quote-gallery-image" src="images/Photos/images (4).webp" alt=""/>
        </div>
        <div class="quote-gallery-item" tabindex="-1" aria-hidden="true">
          <img class="quote-gallery-image" src="images/Photos/images (1).webp" alt=""/>
        </div>
        <div class="quote-gallery-item" tabindex="-1" aria-hidden="true">
          <img class="quote-gallery-image" src="images/Photos/images (2).webp" alt=""/>
        </div>
        <div class="quote-gallery-item" tabindex="-1" aria-hidden="true">
          <img class="quote-gallery-image" src="images/Photos/images (3).webp" alt=""/>
        </div>
        <div class="quote-gallery-item" tabindex="-1" aria-hidden="true">
          <img class="quote-gallery-image" src="images/Photos/images (4).webp" alt=""/>
        </div>
      </div>
    </div>
  </div>
  <script>
    (() => {
      const container = document.currentScript?.previousElementSibling?.querySelector('[data-quote-gallery]');
      if (!container) return;

      const track = container.querySelector('.quote-gallery-track');
      if (!track) return;

      let isDown = false;
      let isPaused = false;
      let startX = 0;
      let scrollLeft = 0;
      let resumeTimeout;

      const pauseAutoScroll = () => {
        isPaused = true;
        clearTimeout(resumeTimeout);
        resumeTimeout = setTimeout(() => {
          isPaused = false;
        }, 2000);
      };

      container.addEventListener('pointerdown', (e) => {
        isDown = true;
        container.classList.add('is-dragging');
        container.setPointerCapture(e.pointerId);
        startX = e.clientX;
        scrollLeft = container.scrollLeft;
        pauseAutoScroll();
      });

      container.addEventListener('pointerleave', () => {
        if (!isDown) return;
        isDown = false;
        container.classList.remove('is-dragging');
      });

      container.addEventListener('pointerup', (e) => {
        if (container.hasPointerCapture(e.pointerId)) {
          container.releasePointerCapture(e.pointerId);
        }
        isDown = false;
        container.classList.remove('is-dragging');
        pauseAutoScroll();
      });

      container.addEventListener('pointermove', (e) => {
        if (!isDown) return;
        e.preventDefault();
        const walk = (e.clientX - startX) * 1.5;
        container.scrollLeft = scrollLeft - walk;
      });

      container.addEventListener('wheel', (e) => {
        if (Math.abs(e.deltaX) > Math.abs(e.deltaY)) {
          return;
        }
        container.scrollBy({ left: e.deltaY, behavior: 'smooth' });
        pauseAutoScroll();
        e.preventDefault();
      }, { passive: false });

      const AUTO_SPEED = 0.5;

      const autoScroll = () => {
        if (!isDown && !isPaused) {
          container.scrollLeft += AUTO_SPEED;
          if (container.scrollLeft >= track.scrollWidth - container.clientWidth) {
            container.scrollLeft = 0;
          }
        }
        requestAnimationFrame(autoScroll);
      };

      requestAnimationFrame(autoScroll);
    })();
  </script>
</section>
